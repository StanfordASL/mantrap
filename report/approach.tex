\chapter{Multi-Modal Interaction-Aware Trajectory Optimization}
\label{text:approach}




In this chapter, an overview of the approach is provided. Starting in Section \ref{text:approach/formulation} the problem of socially aware motion planning is formulated formally, including the assumptions made within this project. 
\newline
Section \ref{text:approach/overview} which presents an overview of the full trajectory optimization pipeline. It is shown how the algorithm is built to allow to deal with general graph-like pedestrian behavior prediction models, with multi-modal, probabilistic outputs. Furthermore, the advantages of formulating socially aware motion planning as an optimization problem while utilizing a graph-based prediction model, e.g. deep learning-based models such as the Trajectron \cite{Ivanovic2018}, over purely learned \cite{Chen2017} or purely optimization-based \cite{Berg2011} algorithms are illustrated. Finally, it is explained how the usage of a general-purpose, computation-graph based framework such as PyTorch \cite{pytorch} or TensorFlow \cite{tensorflow} can be harnessed for a highly modular, efficient, and versatile implementation.
\newline
The exact formulation of the optimization problem is further explained in Section \ref{text:approach/objective} and \ref{text:approach/constraint}. Beginning with the objective function both the goal-driven and the interaction-driven parts are illustrated, together with a derivation of their gradients. Furthermore, several designs of the specific objective function are discussed. The subsequent section addresses the design of the constraints used. Likewise, several constraint function designs are compared. 
\newline
To use the system in real-world applications it must comply with several requirements. While some of these have been tackled by the optimization design, e.g. feasibility of the control limitations of the robot or safety regarding robot-human interaction, the system underlies runtime limits. To achieve this goal several runtime improvements have been implemented, which are described in Section \ref{text:approach/runtime}.

\input{problem_formulation}
\input{system_overview}

\section{Objective Function Design}
\label{text:approach/objective}
\input{objective_goal}
\input{objective_interaction}


\section{Constraint Function Design}
\label{text:approach/constraint}
\input{constraint_dynamics}
\input{constraint_safety}


\section{Runtime optimization}
\label{text:approach/runtime}
\input{runtime_unrolling}
\input{runtime_warmstart}
\input{runtime_attention}
