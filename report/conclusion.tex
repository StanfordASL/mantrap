\chapter{Conclusion and Future Work}
\label{text:conclusion}

\section{Conclusion}
\label{text:conclusions/conclusions}
In this thesis, I designed and implemented a new approach of socially-aware trajectory optimization for crowd-navigation. To combine the strengths of purely data-driven and online optimized methodologies, an optimization formulation was purposed that is seamlessly integrating in probabilistic, multi-model, state-of-the-art prediction models. Thereby, it harnesses its predicted distributions over future pedestrian states precisely and without the need of sampling methods.
\newline\newline
By directly leveraging the internal structure of the prediction model itself, the interactive objective function drives the optimization to (socially) anticipative but cautious solutions. An \ac{HJR}-based constraint further guarantees interaction safety within the planning horizon, without being overly conservative.
\newline\newline
For efficiently solving the designed optimization using the interior-point method-based solver \ac{IPOPT} several strategies has been substantiated and implemented.
\newline\newline
Finally, we presented results and validated the final algorithm for an assorted set of pedestrian prediction models in simulation. As the algorithm requires the prediction model to generate a probabilistic distribution over future pedestrian states, a sampled-based algorithm has been purposed for converting deterministic, parametric models into probabilistic ones. In comparison to other state-of-the-art both data-driven as well as conventional, trajectory planning algorithms, the purposed approach shows great performance.

\section{Future Work}
\label{text:conclusions/future_work}
In the following, I list possible extensions and future research directions.

\begin{itemize}
\item For fully integrating the purposed planning methodology into real-world applications, several external determinants have to be considered in planning. While surely the most difficult factor, the interaction with dynamic agents, has been treated within this work, integrating the structure of the environment itself (such as sidewalks, roads, static-obstacles), remains for future work. Since most prediction models such as Trajectron \cite{Salzmann2020} do already support including the environment structure, doing so probably is straight-forward. As previously shown, most data-driven prediction models have been trained on data, that was recorded in structured environments, leading to (unintentional) artifacts in their prediction. Adding structure to the environment therefore may even improve the performance of the overall approach.
\item The bottleneck of the purposed approach clearly are the number of evaluations of the interactive objective and its gradient. \ac{SQP} has shown to require less objective function evaluations compared to interior-point methods, at the cost of intermediate infeasibility. To further improve the efficiency of the algorithm, it might be reasonable to use a \ac{SQP}-based solver such as Gusto \cite{Bonalli2019} instead.
\item Due to the lack of robot-conditioned prediction models the algorithm could only be validated for a selected set of models. A future research direction may be to condition other state-of-the-art pedestrian prediction models on the planned robots trajectory, such as \ac{SGAN} \cite{Gupta2018}, and integrate these into the planning framework. This includes evaluating the framework on other "socially-aware" agent types, such as  bicyclist or cars. Therefore, in theory no non-parametric change in the overall formulation is required.
\item During this work, it is assumed for the robot to underly double integrator dynamics. A generalization of the method to other robot dynamics should be straight-forward.
\item Finally, the algorithm has been tested in simulation only, mainly due to the implications of COVID-19. While several efforts has been introduced to mimic the challenges of a real-world environment as best as possible, they could of course not perfectly matched. Thus, despite of the discussed drawbacks of real-world testing in terms of comparability of the results, it remains for future work to test it in a real-world environment.  
\end{itemize}

The interactive optimization design fully leveraging the predictive power of a learned deep neural network has never been done before for trajectory optimization, to the best of my knowledge. With the raise of data-driven prediction models, it gains increasingly importance to unleash their full predictive power in optimization, in many fields. Therefore, this work can be seen as a proof-of-concept of applying this concept in the field of trajectory optimization but also in many other optimization-driven fields, such as adaptive control, or manufacturing optimization. In contrast to purely learning-based approaches using an online optimization gives raise to the possibility to constraint the solution in a tractable manner. Due to the ongoing trend of neural network compression in many fields computational bounds of the purposed approach will fade. With an increasing amount of computational complex simulation being replaced with data-driven approaches, this work may be one of the foundations for applying neural networks gradients in online optimization !
