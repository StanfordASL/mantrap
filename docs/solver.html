
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Solver &#8212; mantrap 0.1 documentation</title>
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Objective and Constraint Modules" href="modules.html" />
    <link rel="prev" title="Environment" href="environment.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Objective and Constraint Modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="environment.html" title="Environment"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mantrap 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="solver">
<h1>Solver<a class="headerlink" href="#solver" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-mantrap.solver.base.trajopt">
<span id="base-trajectory-solver-abstract"></span><h2>Base Trajectory Solver (abstract)<a class="headerlink" href="#module-mantrap.solver.base.trajopt" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver">
<em class="property">class </em><code class="sig-prename descclassname">mantrap.solver.base.trajopt.</code><code class="sig-name descname">TrajOptSolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.base.graph_based.GraphBasedEnvironment" title="mantrap.environment.base.graph_based.GraphBasedEnvironment">mantrap.environment.base.graph_based.GraphBasedEnvironment</a></span></em>, <em class="sig-param"><span class="n">goal</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">t_planning</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">modules</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">]</span><span class="p">, </span>List<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">attention_module</span><span class="p">:</span> <span class="n">abc.ABCMeta</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eval_env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.base.graph_based.GraphBasedEnvironment" title="mantrap.environment.base.graph_based.GraphBasedEnvironment">mantrap.environment.base.graph_based.GraphBasedEnvironment</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'unknown'</span></em>, <em class="sig-param"><span class="n">is_logging</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">solver_params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>General abstract solver implementation.</p>
<p>The idea of this general implementation is that in order to build a solver class only the <cite>optimize()</cite> method
has to be implemented, that determines the “optimal” value for the optimization variable given its initial value
and the internally stored scene, while the general solver implementation deals with multi-threading and provides
methods for computing the objective and constraint values (given a list of modules which should be taken into
account, see below).</p>
<p>Initialise solver class by building objective and constraint modules as defined within the specific
definition of the (optimisation) problem.</p>
<p>Internally, the solver stores two environments, the environment it uses for planning (optimization etc) and
the environment it uses for evaluation, i.e. which is actually unknown for the solver but encodes the way
the scene actually changes from one time-step to another. If <cite>eval_env = None</cite> the planning and evaluation
environment are the same.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – environment the solver’s forward simulations are based on.</p></li>
<li><p><strong>goal</strong> – goal state (position) of the robot (2).</p></li>
<li><p><strong>t_planning</strong> – planning horizon, i.e. how many future time-steps shall be taken into account in planning.</p></li>
<li><p><strong>multiprocessing</strong> – use multiprocessing for optimization.</p></li>
<li><p><strong>modules</strong> – List of optimization modules and according kwargs (if required).</p></li>
<li><p><strong>attention_module</strong> – Filter module name (None = no filter).</p></li>
<li><p><strong>eval_env</strong> – environment that should be used for evaluation (“real” environment).</p></li>
<li><p><strong>config_name</strong> – name of solver configuration.</p></li>
<li><p><strong>is_logging</strong> – should all the results be logged (necessary for plotting but very costly !!).</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver.constraints">
<code class="sig-name descname">constraints</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ado_ids</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tag</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'optimization'</span></em>, <em class="sig-param"><span class="n">return_violation</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver.constraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine constraints vector for some optimization vector <cite>z</cite>.</p>
<p>This function generally defines the constraints vector for some input optimization vector <cite>z</cite>, and some
list of ados that should be taken into account in this computation. Therefore all constraint modules
are called, their results are concatenated.</p>
<p>For logging purposes additionally the overall constraints violation, i.e. a scalar value representing the
amount of how much each constraint is violated (zero if constraint is not active), summed over all
constraints, is determined and logged, together with the violation by constraint module. Since the
optimization parameters itself already have been logged in the <cite>objective()</cite> method, there are not logged
within the <cite>constraints()</cite> method.</p>
<p>If the optimization is unconstrained, an empty constraint vector as well as zero violation are returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> – optimization vector (shape depends on exact optimization formulation).</p></li>
<li><p><strong>ado_ids</strong> – identifiers of ados that should be taken into account during optimization.</p></li>
<li><p><strong>tag</strong> – name of optimization call (name of the core).</p></li>
<li><p><strong>return_violation</strong> – flag whether to return the overall constraint violation value as well.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>constraints vector w.r.t. <cite>z</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver.encode">
<code class="sig-name descname">encode</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode the current environment-goal-setup in a four-dimensional continuous space.</p>
<p>To represent a given scene completely the following elements have to be taken into
account: the robot state (position, acceleration, type),  the ado states (position,
velocity, history, type) and the goal state. However to reduce dimensionality of
the representation, we simplify the problem to only encode the current states (no
history) and assume single integrator ado and double integrator robot dynamics.
As a consequence the ado’s velocity can be ignored as well (since it can change
instantly due to the single integrator dynamics).</p>
<p>The most important information with respect to the trajectory optimization surely
is the relative position of the goal state, in robot coordinates. Therefore as
an encoding the ado positions are transformed into the coordinate system spanned
by the line from the robot’s to the goal position (and its orthogonal). The
transformed coordinates of the closest pedestrian (w.r.t. the robot) as well as
the robot’s velocity form the scene encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>four-dimensional scene representation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">solver_params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Method can be overwritten when further initialization is required.</p>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver.log_query">
<code class="sig-name descname">log_query</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">key_type</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">iteration</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">tag</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">as_dict</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">stack</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; Union[torch.Tensor, Dict[str, torch.Tensor], None]<a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver.log_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Query internal log for some value with given key (log-key-structure: {tag}/{key_type}_{key}).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> – query key, e.g. name of objective module.</p></li>
<li><p><strong>key_type</strong> – type of query (-&gt; <a href="#id1"><span class="problematic" id="id2">mantrap.constants.LK_</span></a>…).</p></li>
<li><p><strong>iteration</strong> – optimization iteration to search in, if None then no iteration (summarized value).</p></li>
<li><p><strong>tag</strong> – logging tag to search in.</p></li>
<li><p><strong>as_dict</strong> – return query result as dictionary (even if only one-sized).</p></li>
<li><p><strong>stack</strong> – stack tensors if multiple results (shapes not checked !!).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver.module_defaults">
<em class="property">static </em><code class="sig-name descname">module_defaults</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">]</span><span class="p">, </span>List<span class="p">]</span><a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver.module_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>List of optimization modules (objectives, constraint) and according dictionary
of module kwargs, such as weight (for objectives), etc.</p>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver.module_hard">
<em class="property">static </em><code class="sig-name descname">module_hard</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">]</span><span class="p">, </span>List<span class="p">]</span><a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver.module_hard" title="Permalink to this definition">¶</a></dt>
<dd><p>List of “hard” optimization modules (objectives, constraint). Hard modules are used for
warm-starting the trajectory optimization and should therefore be simple to solve while still
encoding a good guess of possible solutions.</p>
<p>By default these modules are assumed to be the goal objective function and the controls limit
constraint, dynamics constraint fulfilled by the solver’s structure.</p>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver.objective">
<code class="sig-name descname">objective</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ado_ids</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tag</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'optimization'</span></em><span class="sig-paren">)</span> &#x2192; float<a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver.objective" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine objective value for some optimization vector <cite>z</cite>.</p>
<p>This function generally defines the value of the objective function for some input optimization vector <cite>z</cite>,
and some input list of ados that should be taken into account in this computation. Therefore all objective
modules are called, their results are summed (module-internally weighted).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> – optimization vector (shape depends on exact optimization formulation).</p></li>
<li><p><strong>ado_ids</strong> – identifiers of ados that should be taken into account during optimization.</p></li>
<li><p><strong>tag</strong> – name of optimization call (name of the core).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weighted sum of objective values w.r.t. <cite>z</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver.optimize_core">
<em class="property">abstract </em><code class="sig-name descname">optimize_core</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z0</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">tag</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">ado_ids</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>torch.Tensor<span class="p">, </span>float<span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>torch.Tensor<span class="p">]</span><span class="p">]</span><a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver.optimize_core" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimization function for single core to find optimal z-vector.</p>
<p>Given some initial value <cite>z0</cite> find the optimal allocation for z with respect to the internally defined
objectives and constraints. This function is executed in every thread in parallel, for different initial
values <cite>z0</cite>. To simplify optimization not all agents in the scene have to be taken into account during
the optimization but only the ones with ids defined in <cite>ado_ids</cite>.</p>
<p>ATTENTION: Since several <cite>optimize_core()</cite> calls are spawned in parallel, one for every process, but
originating from the same solver class, the method should be self-contained. Hence, no internal
variables should be updated, since this would lead to race conditions ! If class variables have
to be altered and used within this function, then assign them to the process tag !</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z0</strong> – initial value of optimization variables.</p></li>
<li><p><strong>tag</strong> – name of optimization call (name of the core).</p></li>
<li><p><strong>ado_ids</strong> – identifiers of ados that should be taken into account during optimization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>z_opt (optimal values of optimization variable vector)
objective_opt (optimal objective value)
optimization_log (logging dictionary for this optimization = self.log)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_steps</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">warm_start_method</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'hard'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>torch.Tensor<span class="p">, </span>torch.Tensor<span class="p">]</span><a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the ego trajectory given the internal environment with the current scene as initial condition.
Therefore iteratively solve the problem for the scene at t = t_k, update the scene using the internal simulator
and the derived ego policy and repeat until t_k = <cite>horizon</cite> or until the goal has been reached.</p>
<p>This method changes the internal environment by forward simulating it over the prediction horizon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_steps</strong> – how many time-steps shall be solved (not planning horizon !).</p></li>
<li><p><strong>warm_start_method</strong> – warm-starting method (see .warm_start()).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>derived ego trajectory [horizon + 1, 5].</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>derived actual ado trajectories [num_ados, 1, horizon + 1, 5].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver.solver_hard">
<em class="property">classmethod </em><code class="sig-name descname">solver_hard</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.base.graph_based.GraphBasedEnvironment" title="mantrap.environment.base.graph_based.GraphBasedEnvironment">mantrap.environment.base.graph_based.GraphBasedEnvironment</a></span></em>, <em class="sig-param"><span class="n">goal</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">t_planning</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">config_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'unknown'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">solver_params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver.solver_hard" title="Permalink to this definition">¶</a></dt>
<dd><p>Create internal solver version with only “hard” optimization modules.</p>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver.visualize_heat_map">
<code class="sig-name descname">visualize_heat_map</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">propagation</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'log'</span></em>, <em class="sig-param"><span class="n">resolution</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver.visualize_heat_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize heat map of objective and constraint function for planned ego trajectory at initial
state of the system.</p>
<p>Therefore span a grid over the full (usually 2D) optimization state space and compute the objective
value as well as the constraint violation for each grid point. Overlaying the grid point values
computed for each optimization module creates the shown heat-map.</p>
<p>The <cite>propagation</cite> mode determines the way how the z values are chosen over time. Plotting every
possible state combination over the full planning horizon surely is in-feasible. Therefore there
are several propagation modes possible:</p>
<ul class="simple">
<li><dl class="simple">
<dt>“log”: Choose the optimization values as it was chosen during the last optimization, i.e. the ones</dt><dd><p>stored in the internal logging. Hence, when plotting the kth heat-map, only the kth value
is sampled, while the (k-1) z-values before are used from the optimal trajectory in the logging.
Requires solver.solve() call in before !</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>“constant”: Keep z-values constant over whole time-horizon, e.g. when the optimization variables are</dt><dd><p>the robot’s controls than use the same action over the full time-horizon. Hence, the
optimization variable space has to be sampled only once per time-step.</p>
</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver.visualize_scenes">
<code class="sig-name descname">visualize_scenes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tag</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'optimization'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">vis_keys</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver.visualize_scenes" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize planned trajectory over full time-horizon as well as simulated ado reactions (i.e. their
trajectories conditioned on the planned ego trajectory).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tag</strong> – logging tag to plot, per default optimization tag.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.trajopt.TrajOptSolver.warm_start">
<code class="sig-name descname">warm_start</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">method</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'hard'</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="headerlink" href="#mantrap.solver.base.trajopt.TrajOptSolver.warm_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute warm-start for optimization decision variables z.</p>
<ul class="simple">
<li><dl class="simple">
<dt>hard: solve the same optimization process but use the hard optimization modules (</dt><dd><p>objectives and constraints) only.</p>
</dd>
</dl>
</li>
<li><p>encoding:</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>method</strong> – method to use.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>initial z values.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mantrap.solver.base.ipopt">
<span id="ipopt-solvers"></span><h2>IPOPT - Solvers<a class="headerlink" href="#module-mantrap.solver.base.ipopt" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mantrap.solver.base.ipopt.IPOPTIntermediate">
<em class="property">class </em><code class="sig-prename descclassname">mantrap.solver.base.ipopt.</code><code class="sig-name descname">IPOPTIntermediate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.base.graph_based.GraphBasedEnvironment" title="mantrap.environment.base.graph_based.GraphBasedEnvironment">mantrap.environment.base.graph_based.GraphBasedEnvironment</a></span></em>, <em class="sig-param"><span class="n">goal</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">t_planning</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">modules</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">]</span><span class="p">, </span>List<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">attention_module</span><span class="p">:</span> <span class="n">abc.ABCMeta</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eval_env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.base.graph_based.GraphBasedEnvironment" title="mantrap.environment.base.graph_based.GraphBasedEnvironment">mantrap.environment.base.graph_based.GraphBasedEnvironment</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'unknown'</span></em>, <em class="sig-param"><span class="n">is_logging</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">solver_params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.base.ipopt.IPOPTIntermediate" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="mantrap.solver.base.ipopt.IPOPTIntermediate.gradient">
<code class="sig-name descname">gradient</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ado_ids</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tag</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'optimization'</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#mantrap.solver.base.ipopt.IPOPTIntermediate.gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Gradient computation function.</p>
<p>Compute the objectives gradient for some value of the optimization variable <cite>z</cite> based on the
gradient implementations of the objective modules. Sum all these gradients together for the
final gradient estimate.</p>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.ipopt.IPOPTIntermediate.jacobian">
<code class="sig-name descname">jacobian</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ado_ids</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tag</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'optimization'</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#mantrap.solver.base.ipopt.IPOPTIntermediate.jacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Jacobian computation function.</p>
<p>Compute the constraints jacobian for some value of the optimization variable <cite>z</cite> based on the
jacobian implementations of the constraints modules. Concatenate all these gradients together
for the final jacobian estimate.</p>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.ipopt.IPOPTIntermediate.module_hard">
<em class="property">static </em><code class="sig-name descname">module_hard</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">]</span><span class="p">, </span>List<span class="p">]</span><a class="headerlink" href="#mantrap.solver.base.ipopt.IPOPTIntermediate.module_hard" title="Permalink to this definition">¶</a></dt>
<dd><p>List of “hard” optimization modules (objectives, constraint). Hard modules are used for
warm-starting the trajectory optimization and should therefore be simple to solve while still
encoding a good guess of possible solutions.</p>
<p>The IPOPT solver already uses the optimization variable boundaries as control limit, since we
optimize for z = controls. Therefore only the goal module is required as a hard module.</p>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.ipopt.IPOPTIntermediate.optimize_core">
<code class="sig-name descname">optimize_core</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z0</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">ado_ids</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">tag</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'optimization'</span></em>, <em class="sig-param"><span class="n">max_cpu_time</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">3.0</span></em>, <em class="sig-param"><span class="n">approx_jacobian</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">solver_kwargs</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>torch.Tensor<span class="p">, </span>float<span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>torch.Tensor<span class="p">]</span><span class="p">]</span><a class="headerlink" href="#mantrap.solver.base.ipopt.IPOPTIntermediate.optimize_core" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimization function for single core to find optimal z-vector.</p>
<p>Given some initial value <cite>z0</cite> find the optimal allocation for z with respect to the internally defined
objectives and constraints. This function is executed in every thread in parallel, for different initial
values <cite>z0</cite>. To simplify optimization not all agents in the scene have to be taken into account during
the optimization but only the ones with ids defined in <cite>ado_ids</cite>.</p>
<p>ATTENTION: Since several <cite>optimize_core()</cite> calls are spawned in parallel, one for every process, but
originating from the same solver class, the method should be self-contained. Hence, no internal
variables should be updated, since this would lead to race conditions !</p>
<p>IPOPT-Solver poses the optimization problem as Non-Linear Program (NLP) and uses the non-linear optimization
library IPOPT (with Mumps backend) to solve it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z0</strong> – initial value of optimization variables.</p></li>
<li><p><strong>tag</strong> – name of optimization call (name of the core).</p></li>
<li><p><strong>ado_ids</strong> – identifiers of ados that should be taken into account during optimization.</p></li>
<li><p><strong>max_cpu_time</strong> – maximal cpu time until return.</p></li>
<li><p><strong>approx_jacobian</strong> – if True automatic approximation of Jacobian based on finite-difference values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>z_opt (optimal values of optimization variable vector)
objective_opt (optimal objective value)
optimization_log (logging dictionary for this optimization = self.log)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="section" id="module-mantrap.solver.sgrad">
<span id="s-grad-ipopt"></span><h3>S-GRAD-IPOPT<a class="headerlink" href="#module-mantrap.solver.sgrad" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="mantrap.solver.sgrad.SGradSolver">
<em class="property">class </em><code class="sig-prename descclassname">mantrap.solver.sgrad.</code><code class="sig-name descname">SGradSolver</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.base.graph_based.GraphBasedEnvironment" title="mantrap.environment.base.graph_based.GraphBasedEnvironment">mantrap.environment.base.graph_based.GraphBasedEnvironment</a></span></em>, <em class="sig-param"><span class="n">goal</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">t_planning</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">modules</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">]</span><span class="p">, </span>List<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">attention_module</span><span class="p">:</span> <span class="n">abc.ABCMeta</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eval_env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.base.graph_based.GraphBasedEnvironment" title="mantrap.environment.base.graph_based.GraphBasedEnvironment">mantrap.environment.base.graph_based.GraphBasedEnvironment</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'unknown'</span></em>, <em class="sig-param"><span class="n">is_logging</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">solver_params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.sgrad.SGradSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>Shooting NLP using IPOPT solver.</p>
<div class="math notranslate nohighlight">
\[z = controls\]</div>
<div class="math notranslate nohighlight">
\[J(z) = J_{goal} + J_{interaction}\]</div>
<div class="math notranslate nohighlight">
\[C(z) = [C_{max-speed}, C_{min-distance}]\]</div>
<dl class="py method">
<dt id="mantrap.solver.sgrad.SGradSolver.module_defaults">
<em class="property">static </em><code class="sig-name descname">module_defaults</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">]</span><span class="p">, </span>List<span class="p">]</span><a class="headerlink" href="#mantrap.solver.sgrad.SGradSolver.module_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>List of optimization modules (objectives, constraint) and according dictionary
of module kwargs, such as weight (for objectives), etc.</p>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-mantrap.solver.base.search">
<span id="search-solvers"></span><h2>Search - Solvers<a class="headerlink" href="#module-mantrap.solver.base.search" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mantrap.solver.base.search.SearchIntermediate">
<em class="property">class </em><code class="sig-prename descclassname">mantrap.solver.base.search.</code><code class="sig-name descname">SearchIntermediate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.base.graph_based.GraphBasedEnvironment" title="mantrap.environment.base.graph_based.GraphBasedEnvironment">mantrap.environment.base.graph_based.GraphBasedEnvironment</a></span></em>, <em class="sig-param"><span class="n">goal</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">t_planning</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">modules</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">]</span><span class="p">, </span>List<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">attention_module</span><span class="p">:</span> <span class="n">abc.ABCMeta</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eval_env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.base.graph_based.GraphBasedEnvironment" title="mantrap.environment.base.graph_based.GraphBasedEnvironment">mantrap.environment.base.graph_based.GraphBasedEnvironment</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'unknown'</span></em>, <em class="sig-param"><span class="n">is_logging</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">solver_params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.base.search.SearchIntermediate" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="mantrap.solver.base.search.SearchIntermediate.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ado_ids</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">tag</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>float<span class="p">, </span>float<span class="p">]</span><a class="headerlink" href="#mantrap.solver.base.search.SearchIntermediate.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate “value” of z-values, i.e. some choice of optimization variable assignment, by computing
the overall objective value as well as the constraint violation (aka the feasibility of the choice).</p>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.search.SearchIntermediate.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">solver_params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.base.search.SearchIntermediate.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Method can be overwritten when further initialization is required.</p>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.base.search.SearchIntermediate.optimize_core">
<code class="sig-name descname">optimize_core</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z0</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">ado_ids</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">tag</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'optimization'</span></em>, <em class="sig-param"><span class="n">max_cpu_time</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.5</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">solver_kwargs</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>torch.Tensor<span class="p">, </span>float<span class="p">, </span>Dict<span class="p">[</span>str<span class="p">, </span>torch.Tensor<span class="p">]</span><span class="p">]</span><a class="headerlink" href="#mantrap.solver.base.search.SearchIntermediate.optimize_core" title="Permalink to this definition">¶</a></dt>
<dd><p>Optimization function for single core to find optimal z-vector.</p>
<p>Given some initial value <cite>z0</cite> find the optimal allocation for z with respect to the internally defined
objectives and constraints. This function is executed in every thread in parallel, for different initial
values <cite>z0</cite>. To simplify optimization not all agents in the scene have to be taken into account during
the optimization but only the ones with ids defined in <cite>ado_ids</cite>.</p>
<p>ATTENTION: Since several <cite>optimize_core()</cite> calls are spawned in parallel, one for every process, but
originating from the same solver class, the method should be self-contained. Hence, no internal
variables should be updated, since this would lead to race conditions !</p>
<p>In general searching algorithms (at least the ones implemented within this project) have a similar
“frame”, which is some termination constraint, here the computation runtime, and some inner optimization
loop which repeats until the algorithm has either terminated or is done.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z0</strong> – initial value of optimization variables.</p></li>
<li><p><strong>tag</strong> – name of optimization call (name of the core).</p></li>
<li><p><strong>ado_ids</strong> – identifiers of ados that should be taken into account during optimization.</p></li>
<li><p><strong>max_cpu_time</strong> – maximal cpu runtime for optimization.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>z_opt (optimal values of optimization variable vector)
objective_opt (optimal objective value)
optimization_log (logging dictionary for this optimization = self.log)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="section" id="module-mantrap.solver.mcts">
<span id="monte-carlo-tree-search"></span><h3>Monte-Carlo-Tree-Search<a class="headerlink" href="#module-mantrap.solver.mcts" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="mantrap.solver.mcts.MonteCarloTreeSearch">
<em class="property">class </em><code class="sig-prename descclassname">mantrap.solver.mcts.</code><code class="sig-name descname">MonteCarloTreeSearch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.base.graph_based.GraphBasedEnvironment" title="mantrap.environment.base.graph_based.GraphBasedEnvironment">mantrap.environment.base.graph_based.GraphBasedEnvironment</a></span></em>, <em class="sig-param"><span class="n">goal</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">t_planning</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">modules</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">]</span><span class="p">, </span>List<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">attention_module</span><span class="p">:</span> <span class="n">abc.ABCMeta</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eval_env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.base.graph_based.GraphBasedEnvironment" title="mantrap.environment.base.graph_based.GraphBasedEnvironment">mantrap.environment.base.graph_based.GraphBasedEnvironment</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'unknown'</span></em>, <em class="sig-param"><span class="n">is_logging</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">solver_params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.mcts.MonteCarloTreeSearch" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="mantrap.solver.mcts.MonteCarloTreeSearch.module_defaults">
<em class="property">static </em><code class="sig-name descname">module_defaults</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">]</span><span class="p">, </span>List<span class="p">]</span><a class="headerlink" href="#mantrap.solver.mcts.MonteCarloTreeSearch.module_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>List of optimization modules (objectives, constraint) and according dictionary
of module kwargs, such as weight (for objectives), etc.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mantrap.solver.baselines.random_search">
<span id="random-search"></span><h3>Random Search<a class="headerlink" href="#module-mantrap.solver.baselines.random_search" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="mantrap.solver.baselines.random_search.RandomSearch">
<em class="property">class </em><code class="sig-prename descclassname">mantrap.solver.baselines.random_search.</code><code class="sig-name descname">RandomSearch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.base.graph_based.GraphBasedEnvironment" title="mantrap.environment.base.graph_based.GraphBasedEnvironment">mantrap.environment.base.graph_based.GraphBasedEnvironment</a></span></em>, <em class="sig-param"><span class="n">goal</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">t_planning</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">modules</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">]</span><span class="p">, </span>List<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">attention_module</span><span class="p">:</span> <span class="n">abc.ABCMeta</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eval_env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.base.graph_based.GraphBasedEnvironment" title="mantrap.environment.base.graph_based.GraphBasedEnvironment">mantrap.environment.base.graph_based.GraphBasedEnvironment</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">config_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'unknown'</span></em>, <em class="sig-param"><span class="n">is_logging</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">solver_params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.baselines.random_search.RandomSearch" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="mantrap.solver.baselines.random_search.RandomSearch.module_defaults">
<em class="property">static </em><code class="sig-name descname">module_defaults</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>List<span class="p">[</span>Tuple<span class="p">]</span><span class="p">, </span>List<span class="p">]</span><a class="headerlink" href="#mantrap.solver.baselines.random_search.RandomSearch.module_defaults" title="Permalink to this definition">¶</a></dt>
<dd><p>List of optimization modules (objectives, constraint) and according dictionary
of module kwargs, such as weight (for objectives), etc.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Solver</a><ul>
<li><a class="reference internal" href="#module-mantrap.solver.base.trajopt">Base Trajectory Solver (abstract)</a></li>
<li><a class="reference internal" href="#module-mantrap.solver.base.ipopt">IPOPT - Solvers</a><ul>
<li><a class="reference internal" href="#module-mantrap.solver.sgrad">S-GRAD-IPOPT</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-mantrap.solver.base.search">Search - Solvers</a><ul>
<li><a class="reference internal" href="#module-mantrap.solver.mcts">Monte-Carlo-Tree-Search</a></li>
<li><a class="reference internal" href="#module-mantrap.solver.baselines.random_search">Random Search</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="environment.html"
                        title="previous chapter">Environment</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="modules.html"
                        title="next chapter">Objective and Constraint Modules</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/solver.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="modules.html" title="Objective and Constraint Modules"
             >next</a> |</li>
        <li class="right" >
          <a href="environment.html" title="Environment"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mantrap 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Simon Schaefer.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.4.
    </div>
  </body>
</html>