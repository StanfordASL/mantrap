
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>Objective Modules &#8212; mantrap 0.1 documentation</title>
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Filter Modules" href="filter.html" />
    <link rel="prev" title="Constraint Modules" href="constraints.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="filter.html" title="Filter Modules"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="constraints.html" title="Constraint Modules"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mantrap 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="objective-modules">
<h1>Objective Modules<a class="headerlink" href="#objective-modules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-mantrap.solver.objectives.objective_module">
<span id="abstract-objective"></span><h2>Abstract Objective<a class="headerlink" href="#module-mantrap.solver.objectives.objective_module" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mantrap.solver.objectives.objective_module.ObjectiveModule">
<em class="property">class </em><code class="sig-prename descclassname">mantrap.solver.objectives.objective_module.</code><code class="sig-name descname">ObjectiveModule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">t_horizon</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">weight</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">module_kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.objectives.objective_module.ObjectiveModule" title="Permalink to this definition">¶</a></dt>
<dd><p>General objective class.</p>
<p>For an unified and general implementation of the objective function modules this superclass implements methods
for computing and logging the objective value as well as the gradient vector simply based on a single method,
the <cite>_compute()</cite> method, which has to be implemented in the child classes. <cite>_compute()</cite> returns the objective value
given a planned ego trajectory, while building a torch computation graph, which is used later on to determine the
gradient vector using the PyTorch autograd library. Each output (objective &amp; gradient) are multiplied with it’s
importance weight.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_horizon</strong> – planning time horizon in number of time-steps (&gt;= 1).</p></li>
<li><p><strong>weight</strong> – objective importance weight.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="mantrap.solver.objectives.objective_module.ObjectiveModule.gradient">
<code class="sig-name descname">gradient</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ego_trajectory</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">grad_wrt</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">ado_ids</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="headerlink" href="#mantrap.solver.objectives.objective_module.ObjectiveModule.gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine gradient vector for passed ego trajectory. Therefore determine the objective value by
calling the internal <cite>compute()</cite> method and en passant build a computation graph. Then using the pytorch
autograd library compute the gradient vector through the previously built computation graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ego_trajectory</strong> – planned ego trajectory (t_horizon, 5).</p></li>
<li><p><strong>grad_wrt</strong> – vector w.r.t. which the gradient should be determined.</p></li>
<li><p><strong>ado_ids</strong> – ghost ids which should be taken into account for computation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mantrap.solver.objectives.objective_module.ObjectiveModule.objective">
<code class="sig-name descname">objective</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ego_trajectory</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">ado_ids</span><span class="p">:</span> <span class="n">List<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; float<a class="headerlink" href="#mantrap.solver.objectives.objective_module.ObjectiveModule.objective" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine objective value for passed ego trajectory by calling the internal <cite>compute()</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ego_trajectory</strong> – planned ego trajectory (t_horizon, 5).</p></li>
<li><p><strong>ado_ids</strong> – ghost ids which should be taken into account for computation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mantrap.solver.objectives.goal">
<span id="goal-driven"></span><h2>Goal Driven<a class="headerlink" href="#module-mantrap.solver.objectives.goal" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mantrap.solver.objectives.goal.GoalModule">
<em class="property">class </em><code class="sig-prename descclassname">mantrap.solver.objectives.goal.</code><code class="sig-name descname">GoalModule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">goal</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">module_kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.objectives.goal.GoalModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Loss based on goal distance of every point of planned robot trajectory.</p>
<p>Next to avoiding interaction with other agents the robot should reach the goal state in a finite amount of
time. Therefore the distance of every trajectory point to the goal state is taken to account, which is
minimized the faster the robot gets to the goal. However, it is more important for the last rather than the
first trajectory points to be close to the goal, therefore the distance are weighted using a cubic distribution.</p>
<div class="math notranslate nohighlight">
\[objective = \sum_{T} w_t || pos_t - goal ||_2\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>goal</strong> – goal state/position for robot agent (2).</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mantrap.solver.objectives.control_effort">
<span id="control-effort"></span><h2>Control Effort<a class="headerlink" href="#module-mantrap.solver.objectives.control_effort" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mantrap.solver.objectives.control_effort.ControlEffortModule">
<em class="property">class </em><code class="sig-prename descclassname">mantrap.solver.objectives.control_effort.</code><code class="sig-name descname">ControlEffortModule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.environment.GraphBasedEnvironment" title="mantrap.environment.environment.GraphBasedEnvironment">mantrap.environment.environment.GraphBasedEnvironment</a></span></em>, <em class="sig-param"><span class="o">**</span><span class="n">module_kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.objectives.control_effort.ControlEffortModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Loss based on ego control effort.</p>
<p>A typical objective in control theory is to reach some goal using a minimal amount of control energy (effort).
In the use case of navigating through a crowd of pedestrians this objective is not priority, sacrificing some
control energy for the sake of less interfering with pedestrians seems to be a feasible approach. Therefore
constraining the amount of control energy which the robot is able to use in every step might be sufficient,
however for completeness (and comparison) this objective is implemented:</p>
<div class="math notranslate nohighlight">
\[objective =  \sum_{T} || u_t ||_2\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>env</strong> – solver’s environment environment for ego dynamics.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mantrap.solver.objectives.acc_interact">
<span id="acceleration-interaction"></span><h2>Acceleration Interaction<a class="headerlink" href="#module-mantrap.solver.objectives.acc_interact" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mantrap.solver.objectives.acc_interact.InteractionAccelerationModule">
<em class="property">class </em><code class="sig-prename descclassname">mantrap.solver.objectives.acc_interact.</code><code class="sig-name descname">InteractionAccelerationModule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.environment.GraphBasedEnvironment" title="mantrap.environment.environment.GraphBasedEnvironment">mantrap.environment.environment.GraphBasedEnvironment</a></span></em>, <em class="sig-param"><span class="o">**</span><span class="n">module_kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.objectives.acc_interact.InteractionAccelerationModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Loss based on accelerational interaction between robot and ados.</p>
<p>As a proxy for interaction based on the acceleration of every ado is computed in a (fictional) scene without an
ego (robot) and compared to the actual occurring accelerations in the scene. As for autonomous driving the
acceleration can be expressed “moving comfort”, since a change in acceleration, especially a sudden change like
strong de-acceleration, decreases the comfort of the agent.</p>
<p>Re-Predicting it every time-step would be more correct, however it would also require a lot more computational
effort (horizon times as much to be exact). Therefore merely the behavior of the ado without ego is computed
that would occur, if the ego is not there from the beginning.</p>
<div class="math notranslate nohighlight">
\[objective = \sum_{T} \sum_{ghosts} || acc_{t,i} - acc_{t,i}^{wo} ||_2\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>env</strong> – environment for predicting the behaviour without interaction.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mantrap.solver.objectives.pos_interact">
<span id="position-interaction"></span><h2>Position Interaction<a class="headerlink" href="#module-mantrap.solver.objectives.pos_interact" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mantrap.solver.objectives.pos_interact.InteractionPositionModule">
<em class="property">class </em><code class="sig-prename descclassname">mantrap.solver.objectives.pos_interact.</code><code class="sig-name descname">InteractionPositionModule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment.html#mantrap.environment.environment.GraphBasedEnvironment" title="mantrap.environment.environment.GraphBasedEnvironment">mantrap.environment.environment.GraphBasedEnvironment</a></span></em>, <em class="sig-param"><span class="o">**</span><span class="n">module_kwargs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mantrap.solver.objectives.pos_interact.InteractionPositionModule" title="Permalink to this definition">¶</a></dt>
<dd><p>Loss based on positional interaction between robot and ados.</p>
<p>As a proxy for interaction based on the position of every ado is computed in a (fictional) scene without an
ego (robot) and compared to the actual occurring positions in the scene, as in intuitive measure for the change
the robot’s presence introduces to the scene.</p>
<p>Re-Predicting it every time-step would be more correct, however it would also require a lot more computational
effort (horizon times as much to be exact). Therefore merely the behavior of the ado without ego is computed
that would occur, if the ego is not there from the beginning.</p>
<div class="math notranslate nohighlight">
\[objective = \sum_{T} \sum_{ghosts} || pos_{t,i} - pos_{t,i}^{wo} ||_2\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>env</strong> – solver’s environment environment for predicting the behaviour without interaction.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Objective Modules</a><ul>
<li><a class="reference internal" href="#module-mantrap.solver.objectives.objective_module">Abstract Objective</a></li>
<li><a class="reference internal" href="#module-mantrap.solver.objectives.goal">Goal Driven</a></li>
<li><a class="reference internal" href="#module-mantrap.solver.objectives.control_effort">Control Effort</a></li>
<li><a class="reference internal" href="#module-mantrap.solver.objectives.acc_interact">Acceleration Interaction</a></li>
<li><a class="reference internal" href="#module-mantrap.solver.objectives.pos_interact">Position Interaction</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="constraints.html"
                        title="previous chapter">Constraint Modules</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="filter.html"
                        title="next chapter">Filter Modules</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/objectives.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="filter.html" title="Filter Modules"
             >next</a> |</li>
        <li class="right" >
          <a href="constraints.html" title="Constraint Modules"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mantrap 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Simon Schaefer.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.0.3.
    </div>
  </body>
</html>